<!DOCTYPE html>
<html>
<meta charset="utf-8">
<title>Alkaline</title>
<style>
body {
	font-family: 'Helvetica', 'Arial', sans-serif;
	font-size: 1rem;
}
</style>
<head>
</head>

<body>

<h1>Alkaline Technical Documentation</h1>
<h2>Contents</h2>
<nav>
<ul>
	<li></li>
</ul>
</nav>

<h2>Philosophy</h2>

<p>
	Alkaline was originally built upon Rubicon 2 codebase. But over our development period, a great deal of code ended up being changed. Lots of new features, monsters, items, powerups, bug corrections... So it grew up into its own thing. We've borrowed ideas (or entire features altogether) from all the great mods and mod frameworks of our time. Copper, Arcane Dimensions, progs_dump, Zerstorer, Malice, Rubicon Rumble Pack, Quoth... you name it. Also we've got a bunch of exclusive features. Our main focus was on things that we felt would be nice to have in all kinds of base-themed maps.
</p>
<p>
	We've decided to not change anything gameplay-related. All original weapons, monsters and items behave almost exactly the way you've known and loved for the last 25 years. We think it's laudable what mods like Copper or AD have done to improve balance and gameplay, but our intention was to expand over the solid gameplay foundations that vanilla Quake laid, and add a load of new features and mapping quality-of-life enhancements on top of it.
</p>
<p>
	We'll do a more in-depth walkthrough into Alkaline's features, so any mapper can take it as a framework for their own map or mod. We've decided to go through everything that's been changed from vanilla instead of pure Rubicon 2, for an easier understanding.
<p>

<hr>

<h2>Monsters</h2>

<p>Monsters have a multitude of new features.</p>
<h3>Triggered spawning</h3>
<p>By setting the <strong>Trigger Spawned</strong> spawnflag, the monster will only show up after it's been triggered. The following spawnflags can be used together with it:
</p>
<ul><li><strong>Silent spawn</strong>: makes it spawn without making the teleport effect & sound, for when you need to repopulate an area out of the player's view.</li>
<li><strong>Spawn angry</strong>: spawns the monster already in alert state.</li>
<li><strong>Count after spawn</strong>: the monster adds to the map's total monster count only after it's been spawned in.</li>
</ul>

<h3>Monster spawner</h3>
<p>
	Checking the <strong>Monster spawner</strong> flag turns this entity into a monster spawner, that creates a new instance of the monster whenever it's triggered. They always spawn angry, and have a telefrag check, so they may wait for a few seconds until they have room to spawn. The spawned monsters inherit all of the spawner entity's <strong>target*</strong> fields, so you can use it to add to a counter when they're killed for example.
	If you want it to spawn monsters in a defined time interval, you can set it up in conjunction with a <strong>trigger_repeat</strong>.
</p>
<p>The following keys are related to it:</p>

<ul><li><strong>totalspawncount</strong>: When set, the spawner will stop when it has spawned this amount of monsters. Also the total monster counter will start with this value already counted in, unless you set the <strong>Count after spawn</strong> flag as well. By default, it'll spawn monsters indefinitely.</li>
<li><strong>spawncount</strong>: Maximum amount of monsters spawned by this entity that can be alive at the same time (defaults to 10 monsters). If this value is reached, the monsters will stop spawning in from this entity until they're killed. Good for not overwhelming the player with a ludicrous amount of monsters in the same arena. Set to -1 if you want to disable this limit.</li>
</ul>

<h3>Other features</h3>
<ul><li><strong>No sight sound</strong> flag: The monster won't make its sight sound when angry at something.</li>
<li><strong>No infight</strong> flag: The monster won't be angry at another when hit, only at players. Note that it doesn't prevent some other monster from getting angry at it, thus never giving it a chance to fight back.</li>
<li><strong>No idle sounds</strong> flag: The monster won't make any idle sounds when standing still. It'll still make sounds if walking/following path_corners though.</li>
</ul>

<h3>Entity target_infight</h3>
<p>Point entity that makes <strong>target</strong> monster angry at <strong>target2</strong> when triggered.</p>
<p>
By default, the infighting doesn't start mutually, that is, <strong>target2</strong> monster will only get mad back at <strong>target</strong> after it's been attacked. If you want to make them angry at each other instantly, you can set the spawnflag <strong>Mutual hate</strong>.
</p>

<h3>Monsters</h3>
<p>Last, but not least, here's the list of the baddies that come with Alkaline. The other non-base vanilla monsters not mentioned here behave and look the same, but they're all still available to use.

<ul>
	<li><strong>Grunt (monster_army):</strong> 30 HP</li>
	<li><strong>Nail Grunt (monster_nailgrunt):</strong> 30 HP</li>
	<li><strong>Rottweiler (monster_dog):</strong> 25 HP</li>
	<li><strong>Enforcer (monster_enforcer):</strong> 80 HP</li>
	<li><strong>Ogre (monster_ogre):</strong> 200 HP</li>
	<li><strong>Ogre Marksman (monster_ogre_marksman):</strong> 200 HP</li>
	<li><strong>Ogre Berserker (monster_ogreb):</strong> 200 HP</li>
	<li><strong>Axe Grunt (monster_axegrunt):</strong> 75 HP</li>
	<li><strong>Saber Knight (monster_hell_knight):</strong> 250 HP</li>
	<li><strong>Dreadnaught (monster_dreadnaught):</strong> 150 HP</li>
	<li><strong>Centroid (monster_scourge):</strong> 300 HP</li>
	<li><strong>Eel (monster_eel):</strong> 25 HP</li>
	<li><strong>Frogman (monster_frogman):</strong> 100 HP</li>
	<li><strong>Drone (monster_drone):</strong> 100 HP</li>
	<li><strong>Centurion (monster_centurion):</strong> 150 HP</li>
	<li><strong>Probe (monster_probe):</strong> 200 HP</li>
	<li><strong>Floyd Automaton (monster_floyd):</strong> 200 HP</li>
	<li><strong>Mega Enforcer (monster_me):</strong> 150 HP</li>
	<li><strong>Bambler (monster_bambler):</strong> 500 HP</li>
	<li><strong>Hunter (monster_hunter):</strong> 600 HP</li>
	<li><strong>Arachnofloyd (monster_arachnofloyd):</strong> 600 HP</li>
	<li><strong>Lieutenant (monster_super_enforcer):</strong> 120 HP + 1000 armor</li>
	<li><strong>Prowler (monster_rider):</strong> 600-777 HP</li>
	<li><strong>Annihilator (monster_banshee):</strong> 1300 HP</li>
	<li><strong>Armagon (monster_armagon):</strong> 2000-3500 HP</li>
</ul>
<hr>

<h2>Items</h2>

<p>
Alkaline has some new items and item features.
</p>

<h3>Circuitboard</h3>
<p>Deployed through the point entity <strong>item_circuitboard</strong>, the circuitboard (or rather the "17-centimeter Fromitz board") is a completely customizable dummy item that does nothing on its own, nor adds anything to your inventory. It merely fires its targets when picked up. But don't be fooled by its simplicity, because it's where lies all its power. You can use it to trigger any event, say, spreading various circuitboards throughout your map, all targeting the same trigger_counter, that unlocks a door or a super secret for example. Almost every map in Alkaline used it in some way.
</p>
You can set a custom model (<strong>mdl</strong> key), pickup sound file (<strong>noise</strong> key), and pickup name (<strong>netname</strong> key). By default the pickup text will be shown at the top of the screen like any other item, but if you want to suppress that and just centerprint a message instead, you can set the <strong>No pickup text</strong> flag and define the message in the <strong>message</strong> field.
<p>

<h3>Trifecta</h3>
<p>
	The new awesome powerup in Alkaline. Gives you quad-damage, invincibility, and a mega health boost, all in one.
</p>

<h3>Keys</h3>

<p>Alkaline borrows the custom key system from progs_dump. You can create a key using the <strong>item_key_custom</strong> entity, and define a custom model, skin, sound and name. Then on any door you can set the name of the key that will open it. For more details, please refer to the in-editor documentation.</p>

<p>Also from progs_dump comes the <strong>item_key_custom</strong> brush entity. You can use it to "consume" a key from the player's inventory (custom or not) and trigger some event. Like a door would, but with no need for a door.

<h3>Item respawning</h3>
<p>Setting an item's <strong>ritem</strong> key to 1 makes it respawns after a few seconds, customizable through the <strong>respawndelay</strong> key. You also can set the maximum number of respawns through <strong>respawncount</strong>.
</p>
<p>By default, the item makes the traditional teleport sound/fog effect when respawning, but you can change it to the more discreet deathmatch-style respawn effect, through the spawnflag <strong>Spawn with DM effects</strong>.
</p>

<h3>Trigger spawning</h3>
<p>Like monsters, items also support trigger-spawning. Just set the <strong>Trigger spawned</strong> flag and it'll only show up after triggered. You can make it spawn silently using the <strong>Spawn silent</strong> flag.
</p>

<h3>Item positioning</h3>
<p>
	The <strong>Suspended in air</strong> spawnflag makes the item stay in place and never drop to the floor, so it hovers in midair. Quoting Lunaran in a similar Copper feature:
	<blockquote>It's a useful hackaround for items that insist on falling out of the world and vanishing because they don't like where you placed them. This also provides a handy solution to the irritating problem that a monster and an item cannot overlap without pushing the item out of the world.
    Even if items don't fall out of the world when you test your map in your Quake engine port of choice, inconsistent droptofloor() results are not unheard of across ports. Consider it best practice to always mark as SUSPENDED any progression-critical items like keys, or any other item that fires a necessary targetname, even when placed on the ground.</blockquote>
</p>
<p>
	The <strong>Don't start dropped</strong> flag, on the other hand, makes the item to still be affected by gravity, but it will not spawn already dropped the floor directly below it (I.E. it won't run droptofloor() upon spawn). This way the item will fall to the floor only after it has been spawned.
</p>

<h3>Item box model style</h3>
<p>
	By default, Alkaline uses the higher-detail BSP item box models from Rubicon Rumble Pack, but you also have the option to use MDL item boxes from Copper. You can select it through the <strong>itemstyle</strong> key, either on worldspawn to set it globally, or directly on the entity.
</p>

<hr>

<h2>Weapons</h2>

<p>In your arsenal, some old acquaintances have made a return in Alkaline, but there's new stuff too.

<h3>New weapons</h3>

<ul>
	<li><strong>Laser Cannon:</strong> The good-old laser-ricochet chaos-inducing weapon from Scourge of Armagon makes a comeback in Alkaline.</li>
	<li><strong>Chainsaw:</strong> The chainsaw from Zerstörer, with a cool new model, animation and effects, if you like to get up close and personal with your foes.</li>
	<li><strong>Plasma Rifle:</strong> A completely new weapon! Great for mowing down large groups of enemies as quickly as it mows down your cells.</li>
</ul>

<h3>Custom loadout</h3>
<p>You can define a completely custom loadout at map start using the <strong>take_weapons</strong> and <strong>give_weapons</strong> worldspawn keys, as well as each of the ammo types.</p>
<p>First, Alkaline will remove the ones checked in <strong>take_weapons</strong>, then give the ones selected in <strong>give_weapons</strong>. So, if your map would begin with a "shotgun start" (I.E. default inventory), taking away the axe and the shotgun will make the player start with no weapons at all.</p>
<p>Setting any of the <strong>ammo_*</strong> keys will override the current amount with the defined one.</p>
<p>Also, setting the <strong>reset_items</strong> worldspawn key to 1 will force a "shotgun start" on your map regardless of inventory/stats coming from a previous map. Note that the inventory reset is made before applying take/give weapons.</p>

<h3>Axe and shotgun pickups</h3>
<p>Since you have the option to remove the axe and the shotgun from your inventory, we've added them as traditional weapon pickups as well. Deploy them through the <strong>weapon_axe</strong> and <strong>weapon_shotgun</strong> point entities.
</p>

<h3>target_removeitems entity</h3>
<p>Acts the same way as the <strong>take_weapons</strong> worldspawn key, but can be used mid-level. Trigger it to remove the selected weapons from the activating player.

<hr>
<h2>Triggers</h2>

<p>In Alkaline we've gone great lengths to allow advanced scripting and events.</p>

<h3>Multiple targets</h3>
<p>Following Copper's fashion, Alkaline also supports the <strong>target2/target3/target4</strong> keys but not multiple targetnames, as it increases code complexity and stack usage multi-fold. Having only multiple targets is usually enough to cover most cases, and you can always set up some relays if necessary.</p>
<p>An exception is made for some entities that must control or modify other entities that could have their behavior changed when set a targetname, so they can also target a <strong>targetname2</strong> field. Note that the targetname2 field isn't displayed on any entity by default, so you must add it manually when needed. The following entities have that ability:
	<ul>
		<li><strong>target_setstate</strong></li>
		<li><strong>target_setdoor</strong></li>
		<li><strong>misc_shadowcontroller</strong></li>
	</ul>

<h3>Dormant triggers</h3>
<p>One of the first changes to triggers that every mod usually do is allow them to be trigger spawned, and with Alkaline that wouldn't be different. Set <strong>is_waiting</strong> to 1, and the trigger won't be active until you target it. It works with all touchable trigger brush entities.</p>

<h3>Monster-triggerable</h3>
<p><strong>trigger_once</strong> and <strong>trigger_multiple</strong> can be set to be activated by monsters as well as players, so you can set them to fall into traps for example.</p>

<h3>Message all players</h3>
<p>Every entity that can centerprint a message may be set to broadcast it to all connected players. Good for when you have some map-wide event that you want to communicate in a co-op game for example. Just set the spawnflag <strong>message all players</strong> on the messaging entity.</p>

<h3>Repeater/timer trigger</h3>
<p>The <strong>trigger_repeat</strong> entity is a point entity that fires its targets repeatedly on a defined interval after activated. Can keep firing indefinitely or for a limited number of times. Targeting it again stops the firing.
The counter can be optionally not be reset after triggering it again (spawnflag 1), so it functions more like a pause/unpause.</p>

<hr>

<h2>Doors</h2>
<p>The good old <strong>func_door</strong> in Alkaline has been completely revamped.

<h3>Distance and angle</h3>
<p>You have various ways of setting the door's movement:</p>
<ul>
<li>using the traditional <strong>angle</strong> and <strong>lip</strong> keys</li>
<li>using <strong>angle</strong>, but with <strong>distance</strong> instead of lip, to specify a travel distance directly</li>
<li>setting <strong>movedir</strong> as a direct x/y/z distance vector relative to its initial position</li>
<li>setting <strong>mangle</strong> and <strong>distance</strong> to make it move in an arbitrary "pitch yaw 0" angle and linear distance</li>
</ul>

<p>Note that those methods are mutually exclusive, so if you use one of those, remember to remove the keys relative to the others, or else you might have some unexpected behaviour.</p>

<p>You can now set a different closing speed for the door with the <strong>speed2</strong> key. If unset, it'll use the same value as <strong>speed</strong>.
</p>

<h3>Delayed movement</h3>
<p>With this feature you can create more complex multi-entity doors with parts that move independently, but still act like a single door. You can set delayed movement for a door part with the <strong>delay</strong> key, and the timings are automatically reverted when closing, which means that the first door entity to open will be the last to close.</p>

<p><strong>delay2</strong> sets an additional delay for when the door closes. Useful if you need to wait for another door part to set in position before moving.</p>

<h3>Door grouping/linking</h3>
<p>For the delayed movement feature to work as intended, a great deal of work was put into making sure they'll link correctly. By default, all doors whose bounding boxes touch or intersect will belong to a single group, and will always move at the same time. But now you also have the option to manually group them through the <strong>groupname</strong> key. Doors with this field set will ignore the touching algorithm for linking, and will only group with other doors that have the same groupname, regardless of where they're positioned in the map.</p>

<p>That also means that the old-time bug with toggling dual-doors was corrected, so you don't need to set "don't link" anymore for toggling doors.</p>

<p>It's recommended that you set the same key values on all doors in the group, like targets, wait, messages, keys, except those specific for each door part, like angle, distance, speed, delay, sound, etc.</p>

<h3>Sounds</h3>
<p>You can set completely custom sounds to doors. They'll override the default sounds selected through the <strong>sounds</strong> key (either on the door itself or on worldspawn).</p>
<ul>
	<li><strong>noise1</strong>: Sound file for the 'stop moving' sound</li>
	<li><strong>noise2</strong>: Sound file for the 'moving' sound (a looping file is recommended)</li>
	<li><strong>noise3</strong>: Sound file for the 'key required' sound</li>
	<li><strong>noise4</strong>: Sound file for the 'key used' sound</li>
</ul>
<p>
	Due to the new delayed movement features, the new spawnflag <strong>Sound during delay</strong> was added. When set, it'll make this specific door part to start its move sound at the instant the whole group starts moving, and only play the stop sound when all doors finished moving. This way you're able to set a single door in the group to sound during the whole movement sequence, and avoid multiple start/stop sounds overlapping for each entity.
</p>

<h3>Keys</h3>
<p>You can set a door to demand a custom key through the <strong>keyname</strong> field. The keyname must match the one in a <strong>item_key_custom</strong> entity. Refer to the item_key_custom documentation in-editor for more details.</p>

<p>There are two other key-related options:</p>
<ul>
	<li><strong>cnt</strong> key: If set to 1, the player won't have the key removed from their inventory when unlocking, but the door will stay open as usual.</li>
	<li><strong>Doom style unlock</strong> spawnflag: Setting this allows the door to function like a conventional door (opens and closes) after it's been unlocked. Checking it also makes players retain the key in their inventory.</li>
</ul>


<h3>Setting a door position directly</h3>
<p>The <strong>target_setdoor</strong> point entity can directly command a door to open or close, regardless of which state it's in. The <strong>style</strong> key sets the command issued to the targeted door when this entity is triggered. Note that doors with a wait time set will still close again normally afterwards.</p>
<p>If you need to command a door and still want it to retain its "touch to open" behavior, you can make the setdoor entity target the door's <strong>targetname2</strong> field..</p>

<h3>Trigger field</h3>
<p>The door's trigger field is the built-in trigger that makes the door open when something gets close to it. Alkaline lets you have some more control how it's created, or make a completely custom one.</p> 
<p>The default door trigger field size in Quake extends 60 units beyond the whole door's bounding box, in either X/Y directions. Through the spawnflags <strong>Expanded/reduced trigger field</strong>, you can set the trigger field to be expanded by another 24u, or reduced by 52u, in either X or Y direction. If you set both expand and reduce at the same time, they'll sum up, so you'll get a smaller reduction of 28u.</p>
<p>With the <strong>trigger_doortriggerfield</strong> brush entity, you can also define a custom trigger field. Just make it target a door, and it'll override the built-in one.</p>

<hr>
<h2>Plats</h2>
<hr>

<h2>Buttons</h2>
<hr>

<h2>Trains</h2>
<hr>

<h2>State System</h2>
<hr>

<h2>Shadows</h2>
<p>
	Alkaline has full-on support for switchable shadows if your compiling tools can handle it. Every brush entity, except triggers and <strong>func_detail_*</strong> entities, can cast togglable shadows, controllable by the <strong>misc_shadowcontroller</strong> point entity. That's how you need to set it up:
	<ul>
		<li>Create a <strong>_switchableshadow</strong> key in the desired entity and set it to 1;</li>
		<li>Give it a targetname - if the entity changes behaviour when adding a targetname, you can use the special <strong>targetname2</strong> key instead, which will work only for the shadow controller.</li>
		<li>Create a <strong>misc_shadowcontroller</strong> entity targeting the bmodel, and give it a different targetname.</li>
		<li>Triggering the shadow controller toggles the shadow on/off with a fading animation.</li>
	</ul>
	<strong>func_door</strong> and <strong>toggle_visiblewall</strong> don't need to have a controlling misc_shadowcontroler, just setting _switchableshadow to 1 makes it work automatically.
</p>
	
<h3>misc_shadowcontroller entity</h3>
<ul>
	<li><strong>speed</strong>: Controls the time in seconds it takes to fade the shadow in. Setting it to -1 disables fading.</li>
	<li><strong>speed2</strong>: Same as 'speed' but for the fade out animation. If unset it uses the same value as 'speed'.</li>
	<li><strong>spawnflags</strong>:
		<ul>
			<li>
				1. Shadow start off: target entity's switchable shadow start as disabled.
			</li>
		</ul>
	</li>
</ul>
	
<hr>

<h2>Lights</h2>

<p>
	Lights in Alkaline have two new features.
</p>
<ul>
	<li>Styled lights can be toggled by giving it a targetname as usual, but setting the light style into the <strong>style2</strong> key. You can make it fade it in/out by setting a spawnflag.</li>
	<li>You can control a light's style directly with the <strong>target_lightstyle</strong> point entity.</li>
</ul>
<p>Also, there are 2 new decorative light entities.</p>
<ul>
	<li><strong>light_fixture1</strong>: wall-mounted light fixture. Control the model's angle with the <strong>angle2</strong> field. Note that the angle set won't be shown in the editor, only in-game.</li>
	<li><strong>light_beacon</strong>: Floor-mounted red beacon. Has an optional blinking animation, that syncs with light style 16.</li>
</ul>

<hr>
<h2>Environmental Effects</h2>

<hr>
<h2>Gravity</h2>

<hr>
<h2>Fog</h2>

<hr>
<h2>Other Quality-of-Life enhancements</h2>

</body>
</html>